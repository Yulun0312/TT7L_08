<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Reviewer - Details</title>
    <!-- Firebase initialization script -->
    <script type="module">
        // Import Firebase services
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js';
        import { getFirestore, doc, getDoc } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDbB73zNTbrSfZ16txDiGxlMCVo8fi7QRA",
            authDomain: "tt7l-08.firebaseapp.com",
            projectId: "tt7l-08",
            storageBucket: "tt7l-08.appspot.com",
            messagingSenderId: "1091270759875",
            appId: "1:1091270759875:web:be9cda99db91a22bec9976",
            measurementId: "G-WVCJVHKGFX"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

        document.addEventListener('DOMContentLoaded', async function () {
            // Ensure Firestore is initialized and db is available globally
            if (typeof window.db === 'undefined') {
                console.error("Firestore has not been initialized. Make sure the db variable is correctly set in your HTML file.");
                return;
            }

            console.log("Firestore has been initialized", window.db);

            // Retrieve carId from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const carId = urlParams.get('id');

            if (!carId) {
                console.error("Car ID is missing in the URL parameter.");
                return;
            }

            try {
                // Fetch car details from Firestore using carId
                const carDoc = await getDoc(doc(db, 'products', carId));
                
                if (carDoc.exists()) {
                    const carData = carDoc.data();
                    console.log("Car Data:", carData);

                    // Display car details in HTML
                    const detailsContainer = document.createElement('div');
                    detailsContainer.className = 'car-details';
                    detailsContainer.innerHTML = `
                        <h2>${carData.name}</h2>
                        <img src="${carData.imageURL}" alt="${carData.name}">
                        <p>${carData.description}</p>
                    `;
                    
                    // Append details container to the body
                    document.body.appendChild(detailsContainer);
                } else {
                    console.error(`No car found with ID ${carId}`);
                }
            } catch (error) {
                console.error("Error fetching car details:", error);
            }
        });
    </script>
    <link rel="stylesheet" href="css.css">
    <style>
        /* Add any additional styles as needed */
        .car-details {
            max-width: 600px; /* Adjusted max-width for better layout */
            margin: 20px auto; /* Centered margin for better layout */
            padding: 20px; /* Padding for better spacing */
            border: 1px solid #ccc; /* Border for visual clarity */
            border-radius: 10px; /* Rounded corners for visual appeal */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Box shadow for depth */
        }

        .car-details img {
            max-width: 100%; /* Ensure images resize responsively */
            height: auto; /* Maintain aspect ratio */
            display: block; /* Prevent extra space beneath images */
            margin-bottom: 10px; /* Space below images */
        }
    </style>
</head>
<body>
    <div id="header">
        <div id="title">Car Reviewer</div>
        <div id="header-middle">
            <a href="home.html">Home</a>
            <a href="categories.html">Categories</a>
            <a href="toplikes.html">Top Likes</a>
            <a href="profile.html">Profile</a>
            <a href="history.html">View History</a>
            <button id="login-button">Log In</button>
        </div>
    </div>

    <!-- Your custom script file -->
    <script type="module" src="app.js"></script>
</body>
</html>
